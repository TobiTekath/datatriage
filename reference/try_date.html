<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Try conversion to date representation — try_date • datatriage</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Try conversion to date representation — try_date"><meta name="description" content="Try conversion of a date serial value to the respective date representation.
Return the date object or its character representation if conversion succeeds, the original value if it does not.
Allows to only convert dates above and/or below a min/max date."><meta property="og:description" content="Try conversion of a date serial value to the respective date representation.
Return the date object or its character representation if conversion succeeds, the original value if it does not.
Allows to only convert dates above and/or below a min/max date."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">datatriage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TobiTekath/datatriage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Try conversion to date representation</h1>
      <small class="dont-index">Source: <a href="https://github.com/TobiTekath/datatriage/blob/master/R/try_date.R" class="external-link"><code>R/try_date.R</code></a></small>
      <div class="d-none name"><code>try_date.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Try conversion of a date serial value to the respective date representation.
Return the date object or its character representation if conversion succeeds, the original value if it does not.
Allows to only convert dates above and/or below a min/max date.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">try_date</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"excel"</span>, <span class="st">"excel_off1"</span>, <span class="st">"excel_1904"</span>, <span class="st">"unix"</span><span class="op">)</span>,</span>
<span>  min_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_character <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A single atomic value, i.e. one string, number or element.</p></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>The origin of the serial value, i.e. the day 0. See description for list of supported options.</p></dd>


<dt id="arg-min-date">min_date<a class="anchor" aria-label="anchor" href="#arg-min-date"></a></dt>
<dd><p>Set a minimum date for conversion. Use format <code>YYYY-MM-DD</code>.</p></dd>


<dt id="arg-max-date">max_date<a class="anchor" aria-label="anchor" href="#arg-max-date"></a></dt>
<dd><p>Set a maximum date for conversion. Use format <code>YYYY-MM-DD</code>.</p></dd>


<dt id="arg-return-character">return_character<a class="anchor" aria-label="anchor" href="#arg-return-character"></a></dt>
<dd><p>Return the character representation of the converted object, rather than the date object.
Does not affect return of unsuccessful conversions. Returns in Format <code>YYYY-MM-DD</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Potentially the date representation of <code>x</code>, <code>x</code> otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Origin</strong>: Correct conversion relies on the correct origin for the serial value.
Available options are:</p><ul><li><p><code>excel</code>: Set the origin to <code>1899-12-30</code>. This is the default date origin in Excel for Windows and for Mac since 2011.</p></li>
<li><p><code>excel_off1</code>: Set the origin to <code>1899-12-31</code>. This might be useful to tackle Excel's 1900 Leap Year Bug for dates before before the 28th of February 1900.</p></li>
<li><p><code>excel_1904</code>: Set the origin to <code>1904-01-01</code>. This is the date origin for the Excel 1904 date system, which was default in early versions of Excel for Mac.</p></li>
<li><p><code>unix</code>: Set the origin to <code>1970-01-01</code>. This is Epoch time used by unix-based systems.</p></li>
</ul><p>For more details about the date origin used in Excel, see <a href="https://support.microsoft.com/en-us/office/date-systems-in-excel-e7fe7167-48a9-4b96-bb53-5612a800b487" class="external-link">Microsoft</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="try_dates.html">try_dates()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Excel has converted a date to a serial number, e.g. 40729</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert to date representation</span></span></span>
<span class="r-in"><span><span class="fu">try_date</span><span class="op">(</span><span class="st">"40729"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2011-07-05"</span>
<span class="r-in"><span><span class="fu">try_date</span><span class="op">(</span><span class="fl">40729</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2011-07-05"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># no conversion for incompatible data types</span></span></span>
<span class="r-in"><span><span class="fu">try_date</span><span class="op">(</span><span class="st">"hello"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hello"</span>
<span class="r-in"><span><span class="fu">try_date</span><span class="op">(</span><span class="st">"1900-01-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1900-01-01"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set min or max date to only convert values in range</span></span></span>
<span class="r-in"><span><span class="fu">try_date</span><span class="op">(</span><span class="st">"40729"</span>, min_date <span class="op">=</span> <span class="st">"2011-07-06"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "40729"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tobias Tekath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

